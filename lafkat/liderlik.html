<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lafkat – Liderlik</title>
<meta name="description" content="Lafkat Liderlik – Günlük, Haftalık, Aylık ve Genel puan tabloları." />
<style>
  :root{
    --orange-1:#ff7a1a; --orange-2:#f36a00;
    --card:#fff9f2; --ink:#2b2b2b; --muted:#7b7b7b; --ring:rgba(0,0,0,.08);
    --shadow:0 8px 24px rgba(0,0,0,.18), 0 2px 6px rgba(0,0,0,.08);
    --radius:18px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--ink);
    background:
      radial-gradient(90vmax 90vmax at 100% -10%, rgba(255,255,255,.08), transparent 60%),
      linear-gradient(180deg,var(--orange-1),var(--orange-2));
    background-attachment:fixed;
  }
  /* Topbar & Drawer */
  .topbar{position:sticky;top:0;z-index:60;backdrop-filter:blur(6px);background:rgba(255,255,255,.30);border-bottom:1px solid rgba(255,255,255,.45)}
  .topbar-inner{max-width:1200px;margin:auto;padding:10px 16px;display:flex;align-items:center;gap:10px}
  .hamburger button{appearance:none;background:#fff;border:1px solid rgba(0,0,0,.12);border-radius:10px;padding:8px 10px;font-weight:800;cursor:pointer}
  .brand{display:flex;align-items:center;gap:10px;font-weight:900}
  .brand img{width:34px;height:34px;border-radius:9px;box-shadow:0 6px 14px rgba(0,0,0,.25)}
  .brand .t{font-size:22px;color:#fff;text-shadow:0 2px 10px rgba(0,0,0,.28)}
  nav.hnav{margin-left:auto;display:none;gap:8px;flex-wrap:wrap}
  nav.hnav a{color:#1b1b1b;text-decoration:none;font-weight:600;background:rgba(255,255,255,.85);padding:8px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.55)}
  nav.hnav a.active{outline:3px solid rgba(255,255,255,.7)}
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);opacity:0;pointer-events:none;transition:opacity .25s;z-index:55}
  .overlay.show{opacity:1;pointer-events:auto}
  .drawer{position:fixed;inset:0 auto 0 0;width:min(84vw,320px);background:#fff;border-right:1px solid rgba(0,0,0,.08);box-shadow:var(--shadow);
          transform:translateX(-100%);transition:transform .25s;z-index:56;display:flex;flex-direction:column}
  .drawer.open{transform:translateX(0)}
  .drawer .head{padding:16px;border-bottom:1px solid rgba(0,0,0,.06);display:flex;align-items:center;gap:10px}
  .drawer nav{display:grid;gap:8px;padding:12px}
  .drawer nav a{padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.08);text-decoration:none;color:#1b1b1b;background:#fff;font-weight:700}
  .drawer .foot{margin-top:auto;padding:12px;border-top:1px solid rgba(0,0,0,.06)}
  @media (min-width:980px){ nav.hnav{display:flex}.hamburger{display:none} }

  /* Page */
  .wrap{max-width:1100px;margin:22px auto;padding:0 16px}
  .grid{display:grid;gap:18px;grid-template-columns: 1fr 320px}
  @media (max-width:980px){ .grid{grid-template-columns:1fr} }

  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--ring)}
  .card .hd{padding:14px 16px;border-bottom:1px solid rgba(0,0,0,.06);font-weight:800}
  .card .bd{padding:14px 16px}

  /* Tabs */
  .tabs{display:flex;gap:6px;padding:8px;background:rgba(255,255,255,.55);border-bottom:1px solid rgba(0,0,0,.06)}
  .tab{flex:1;padding:10px;border:0;border-radius:12px;font-weight:800;cursor:pointer;background:#fff}
  .tab[aria-selected="true"]{background:linear-gradient(180deg,#ffb37a,#ff8e3a)}

  /* Toolbar */
  .toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:10px 0}
  .toolbar input{padding:8px 10px;border:1px solid rgba(0,0,0,.12);border-radius:10px}
  .btn{padding:8px 12px;border-radius:10px;border:1px solid rgba(0,0,0,.1);background:#fff;cursor:pointer;font-weight:800}
  .btn.primary{background:linear-gradient(180deg,#ffb37a,#ff8e3a);color:#3a240e;border:0}
  .hint{font-size:12px;color:var(--muted)}

  /* Table */
  .table-wrap{overflow:auto;max-height:560px}
  table{width:100%;border-collapse:separate;border-spacing:0;background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:12px;overflow:hidden}
  thead th{position:sticky;top:0;background:#fff9f2;border-bottom:1px solid rgba(0,0,0,.08);padding:10px;text-align:left;font-size:13px}
  tbody td{padding:10px;border-bottom:1px solid rgba(0,0,0,.05)}
  tbody tr:last-child td{border-bottom:0}
  .rank{width:64px}
  .nick{min-width:180px}
  .points{font-weight:900}
  .badge{display:inline-block;background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:999px;padding:4px 8px;font-size:12px;margin-right:6px}
  .me{background:#fff5e6}

  /* Side card */
  .side .stat{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .side .s{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:12px;padding:10px;text-align:center}
  .side .v{font-size:20px;font-weight:900}
</style>
</head>
<body>
  <!-- Overlay & Drawer -->
  <div class="overlay" id="overlay"></div>
  <aside class="drawer" id="drawer" aria-hidden="true" aria-label="Menü">
    <div class="head"><img src="assets/logo.png" alt="" width="28" height="28" onerror="this.style.display='none'"><strong>Lafkat Menü</strong></div>
    <nav>
      <a href="index.html">Anasayfa</a>
      <a href="forum.html">Forum</a>
      <a href="liderlik.html">Liderlik</a>
      <a href="arkadaslar.html">Arkadaşlar</a>
      <a href="profil.html">Profil</a>
      <a href="ayarlar.html">Ayarlar</a>
      <a href="#" id="adminLink1" style="display:none">Admin Yönetimi</a>
    </nav>
    <div class="foot"><a href="#" style="text-decoration:none;color:#b12020;font-weight:800">Çıkış</a></div>
  </aside>

  <!-- Topbar -->
  <header class="topbar">
    <div class="topbar-inner">
      <div class="hamburger"><button id="menuBtn" aria-label="Menüyü aç" aria-expanded="false" aria-controls="drawer">☰ Menü</button></div>
      <a class="brand" href="index.html">
        <img src="assets/logo.png" alt="Lafkat" onerror="this.style.display='none'"><span class="t">Lafkat</span>
      </a>
      <nav class="hnav" aria-label="Ana menü">
        <a href="index.html">Anasayfa</a>
        <a href="forum.html">Forum</a>
        <a class="active" href="liderlik.html">Liderlik</a>
        <a href="arkadaslar.html">Arkadaşlar</a>
        <a href="profil.html">Profil</a>
        <a href="ayarlar.html">Ayarlar</a>
        <a href="#" id="adminLink2" style="display:none">Admin Yönetimi</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <!-- MAIN: Leaderboard -->
      <section class="card" aria-labelledby="title">
        <div class="hd" id="title">Liderlik</div>

        <!-- Tabs -->
        <div class="tabs" role="tablist" aria-label="Liderlik sekmeleri">
          <button class="tab" role="tab" id="tab-day" aria-selected="true" aria-controls="panel-day">Günlük</button>
          <button class="tab" role="tab" id="tab-week" aria-selected="false" aria-controls="panel-week">Haftalık</button>
          <button class="tab" role="tab" id="tab-month" aria-selected="false" aria-controls="panel-month">Aylık</button>
          <button class="tab" role="tab" id="tab-all" aria-selected="false" aria-controls="panel-all">Genel</button>
        </div>

        <div class="bd">
          <!-- Toolbar -->
          <div class="toolbar">
            <input type="search" id="search" placeholder="Nickname ara..." />
            <button class="btn" id="clearSearch">Temizle</button>
            <span class="hint" id="rangeHint">Bugün: demo aralığı</span>
            <div style="margin-left:auto;display:flex;gap:8px">
              <button class="btn" id="shareTop3">Top 3’ü Paylaş</button>
              <button class="btn" id="exportCsv">CSV Dışa Aktar</button>
            </div>
          </div>

          <!-- Panels -->
          <div id="panel-day" role="tabpanel" aria-labelledby="tab-day">
            <div class="table-wrap"><table id="tbl-day"></table></div>
          </div>
          <div id="panel-week" role="tabpanel" aria-labelledby="tab-week" class="hidden">
            <div class="table-wrap"><table id="tbl-week"></table></div>
          </div>
          <div id="panel-month" role="tabpanel" aria-labelledby="tab-month" class="hidden">
            <div class="table-wrap"><table id="tbl-month"></table></div>
          </div>
          <div id="panel-all" role="tabpanel" aria-labelledby="tab-all" class="hidden">
            <div class="table-wrap"><table id="tbl-all"></table></div>
          </div>
        </div>
      </section>

      <!-- SIDE: your position -->
      <aside class="card side">
        <div class="hd">Senin Sıralaman</div>
        <div class="bd">
          <div class="s" style="display:flex;align-items:center;gap:12px">
            <div class="avatar" style="width:48px;height:48px;border-radius:50%;display:grid;place-items:center;background:linear-gradient(180deg,#ffe0c6,#ffbf88);border:1px solid rgba(0,0,0,.08);font-weight:900;color:#7a4a16;box-shadow: inset 0 0 0 2px rgba(255,255,255,.7)">T</div>
            <div>
              <div style="font-weight:900" id="meNick">@Tolcay</div>
              <div class="hint">Bugün: <strong id="meRank">#12</strong> · <strong id="mePts">184</strong> puan</div>
            </div>
          </div>
          <div style="height:10px"></div>
          <div class="stat">
            <div class="s"><div class="v" id="meTop">3</div><div class="t">Top 3</div></div>
            <div class="s"><div class="v" id="meBadges">4</div><div class="t">Rozet</div></div>
          </div>
          <div style="margin-top:12px">
            <span class="badge">🎯 Katılımcı</span>
            <span class="badge">🔥 Haftanın Lafkatçısı</span>
            <span class="badge">💬 Yorumcu</span>
          </div>
        </div>
      </aside>
    </div>
  </main>

  <!-- Toast -->
  <div class="toast" id="toast" style="position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:999px;opacity:0;pointer-events:none;transition:opacity .25s;z-index:80"></div>

<script>
  // Admin link (demo)
  (new URLSearchParams(location.search)).get("admin")==="1" && (adminLink1.style.display=adminLink2.style.display="inline-block");

  // Drawer
  const menuBtn=document.getElementById('menuBtn');
  const drawer=document.getElementById('drawer');
  const overlay=document.getElementById('overlay');
  function openDrawer(){drawer.classList.add('open');overlay.classList.add('show');menuBtn.setAttribute('aria-expanded','true');document.body.style.overflow='hidden'; drawer.querySelector('a').focus();}
  function closeDrawer(){drawer.classList.remove('open');overlay.classList.remove('show');menuBtn.setAttribute('aria-expanded','false');document.body.style.overflow='';}
  menuBtn.addEventListener('click', ()=> drawer.classList.contains('open')?closeDrawer():openDrawer());
  overlay.addEventListener('click', closeDrawer);
  window.addEventListener('keydown', e=>{ if(e.key==='Escape' && drawer.classList.contains('open')) closeDrawer(); });

  // Helper UI
  const toastEl=document.getElementById('toast');
  const toast=(m)=>{toastEl.textContent=m;toastEl.style.opacity=1;setTimeout(()=>toastEl.style.opacity=0,1400)};

  // Tabs
  const tabs=[{btn:'tab-day',panel:'panel-day',tbl:'tbl-day'},
              {btn:'tab-week',panel:'panel-week',tbl:'tbl-week'},
              {btn:'tab-month',panel:'panel-month',tbl:'tbl-month'},
              {btn:'tab-all',panel:'panel-all',tbl:'tbl-all'}];
  function switchTo(id){
    tabs.forEach(t=>{
      const b=document.getElementById(t.btn), p=document.getElementById(t.panel);
      const on=t.btn===id; b.setAttribute('aria-selected', on ? 'true':'false'); p.classList.toggle('hidden', !on);
    });
    renderActive(); // keep search/filter applied
  }
  tabs.forEach(t=> document.getElementById(t.btn).addEventListener('click', ()=>switchTo(t.btn)));

  // Demo data
  const base = [
    {nick:'@Aydede', pts:420, badges:['🔥','🎯']},
    {nick:'@KumSaati', pts:396, badges:['🎯']},
    {nick:'@Mimoza', pts:372, badges:['💬']},
    {nick:'@GalaksiTreni', pts:345, badges:['🚀']},
    {nick:'@Lavanta', pts:330, badges:['🎨']},
    {nick:'@Poyraz', pts:312, badges:['💬']},
    {nick:'@SerinSohbet', pts:298, badges:['🎯']},
    {nick:'@RuzgarGülü', pts:260, badges:['🎯']},
    {nick:'@SihirliSilgi', pts:224, badges:['💬']},
    {nick:'@TebeşirTozu', pts:205, badges:['🎯']},
    {nick:'@Tolcay', pts:184, badges:['🎯','💬']},
    {nick:'@Akasya', pts:170, badges:['🎨']},
    {nick:'@KutupYıldızı', pts:162, badges:['❄️']},
    {nick:'@LimonKabuğu', pts:150, badges:['🍋']},
    {nick:'@NarPortakalı', pts:142, badges:['🍊']},
  ];
  const datasets = {
    day: base.map((x,i)=>({...x, pts: Math.max(20, x.pts - (i*9 % 70))})),
    week: base.map((x,i)=>({...x, pts: x.pts + (i*7 % 90)})),
    month: base.map((x,i)=>({...x, pts: x.pts + (i*13 % 150)})),
    all: base
  };

  // Build table HTML
  function buildTable(rows, me='@Tolcay'){
    const header = `
      <thead><tr>
        <th class="rank">Sıra</th>
        <th class="nick">Kullanıcı</th>
        <th>Puan</th>
        <th>Rozetler</th>
      </tr></thead>`;
    const body = rows.map((r,idx)=>{
      const rank = idx+1;
      const medal = rank===1?' 🥇': rank===2?' 🥈': rank===3?' 🥉': '';
      const meCls = r.nick===me ? ' class="me"' : '';
      const badges = r.badges.map(b=>`<span class="badge">${b}</span>`).join('');
      return `<tr${meCls}><td>${rank}${medal}</td><td>${r.nick}</td><td class="points">${r.pts}</td><td>${badges}</td></tr>`;
    }).join('');
    return `${header}<tbody>${body}</tbody>`;
  }

  // Render active table with search filter
  const searchInput = document.getElementById('search');
  const rangeHint = document.getElementById('rangeHint');

  function getActiveKey(){
    if(document.getElementById('tab-day').getAttribute('aria-selected')==='true') return 'day';
    if(document.getElementById('tab-week').getAttribute('aria-selected')==='true') return 'week';
    if(document.getElementById('tab-month').getAttribute('aria-selected')==='true') return 'month';
    return 'all';
  }
  function renderActive(){
    const key = getActiveKey();
    const raw = datasets[key].slice().sort((a,b)=>b.pts-a.pts);
    const q = (searchInput.value||'').trim().toLowerCase();
    const filtered = q ? raw.filter(r=>r.nick.toLowerCase().includes(q)) : raw;

    const tblId = tabs.find(t=>t.btn==='tab-'+key)?.tbl;
    const tbl = document.getElementById(tblId);
    tbl.innerHTML = buildTable(filtered);

    // update me card (based on 'day' data for demo)
    const meNick='@Tolcay';
    const rank = raw.findIndex(r=>r.nick===meNick)+1;
    if(rank>0){
      document.getElementById('meRank').textContent = '#'+rank;
      document.getElementById('mePts').textContent = raw.find(r=>r.nick===meNick).pts;
    }
    // range hint demo text
    const now=new Date();
    const fmt=(d)=> d.toLocaleDateString('tr-TR',{day:'2-digit',month:'2-digit',year:'numeric'});
    let txt='Bugün: '+fmt(now);
    if(key==='week'){
      const dayIdx=(now.getDay()+6)%7; // Pazartesi=0
      const start=new Date(now); start.setDate(now.getDate()-dayIdx);
      const end=new Date(start); end.setDate(start.getDate()+6);
      txt=`Bu hafta: ${fmt(start)} – ${fmt(end)}`;
    }
    if(key==='month'){
      const start=new Date(now.getFullYear(), now.getMonth(), 1);
      const end=new Date(now.getFullYear(), now.getMonth()+1, 0);
      txt=`Bu ay: ${fmt(start)} – ${fmt(end)}`;
    }
    if(key==='all'){ txt='Tüm zamanlar'; }
    rangeHint.textContent = txt;
  }

  // Initial render
  renderActive();

  // Events
  searchInput.addEventListener('input', renderActive);
  document.getElementById('clearSearch').addEventListener('click', ()=>{searchInput.value=''; renderActive();});

  // Share Top 3
  document.getElementById('shareTop3').addEventListener('click', async ()=>{
    const key = getActiveKey();
    const top3 = datasets[key].slice().sort((a,b)=>b.pts-a.pts).slice(0,3);
    const lines = top3.map((r,i)=>`${i+1}. ${r.nick} – ${r.pts}p`).join('\n');
    const text = `Lafkat ${key.toUpperCase()} Top 3\n${lines} #SendeKatıl`;
    try{
      if(navigator.share){ await navigator.share({title:'Lafkat', text}); }
      else{ await navigator.clipboard?.writeText(text); toast('Top 3 panoya kopyalandı'); }
    }catch(e){}
  });

  // Export CSV
  document.getElementById('exportCsv').addEventListener('click', ()=>{
    const key=getActiveKey();
    const rows = datasets[key].slice().sort((a,b)=>b.pts-a.pts);
    const head = ['rank','nick','points','badges'];
    const csv = [head.join(',')].concat(
      rows.map((r,i)=>[i+1, r.nick, r.pts, `"${r.badges.join(' ')}"`].join(','))
    ).join('\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = `lafkat_${key}_leaderboard.csv`;
    a.click();
    URL.revokeObjectURL(a.href);
  });
</script>
</body>
</html>
