
<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>LafKat – Profil</title>
  <link rel="stylesheet" href="assets/style.css"/>
  <script src="assets/app.js"></script>
</head>
<body onload="initProfile()">
  
<div class="topbar">
  <div class="nav">
    <a class="brand brand-link" href="index.html" aria-label="LafKat">
      <img src="assets/logo.svg" alt="" style="width:28px;height:28px" />
      <span>LafKat</span>
    </a>
    <button class="hamburger btn small ghost" onclick="toggleMenu()">☰</button>
    <div class="menu">
      <a href="home.html" data-page="home">Anasayfa</a>
      <a href="forum.html" data-page="forum">Forum</a>
      <a href="leaderboard.html" data-page="leaderboard">Liderlik</a>
      <a href="friends.html" data-page="friends">Arkadaşlar</a>
      <a href="profile.html" data-page="profile">Profil</a>
      <a href="settings.html" data-page="settings">Ayarlar</a>
      <a href="admin.html" class="admin-link" data-page="admin">Admin</a>
      <a href="terms.html" data-page="terms">Şartlar</a>
      <a href="privacy.html" data-page="privacy">Gizlilik</a>
    </div>
    <div class="right">
      <span class="nickname show-when-auth"></span>
      <button class="btn small ghost show-when-auth" onclick="logout()">Oturumu Kapat</button>
      <a class="btn small hide-when-auth" href="index.html">Giriş</a>
      <button class="btn small ghost" onclick="toggleTheme()" title="Tema">🌓</button>
    </div>
  </div>
</div>

  <div class="container">
    <div class="row">
      <div class="card">
        <h3 class="title">Bilgilerim</h3>
        <div class="grid-2">
          <div>
            <label>Ad</label><input class="input" id="p_name" placeholder="Adınız (isteğe bağlı)"/>
            <label>Nickname</label><input class="input" id="p_nick" placeholder="takmaad"/>
          </div>
          <div>
            <label>E-posta</label><input class="input" id="p_mail" placeholder="mail@ornek.com" disabled/>
            <label>Avatar</label><input class="input" type="file" disabled/>
          </div>
        </div>
        <div class="flex" style="margin-top:10px"><button class="btn" onclick="saveProfile()">Kaydet</button></div>
      </div>
      <div class="card">
        <h3 class="title">Özet</h3>
        <p class="subtle">Toplam gönderi: <b id="stat_posts">0</b> • Toplam beğeni: <b id="stat_likes">0</b></p>
        <div class="kicker" style="margin-top:8px">Davet</div>
        <div class="flex"><input class="input" id="invite" placeholder="arkadas@mail.com"/><button class="btn" onclick="toast('Davet linki gönderildi (demo)')">Gönder</button></div>
      </div>
    </div>

    <div class="card">
      <h3 class="title">Gönderilerim</h3>
      <div id="myPosts"></div>
    </div>
  </div>
  <footer>© 2025 LafKat</footer>

<script>
function initProfile(){
  initTopbar('profile');
  const u = getUser();
  if(!u) return location.href='index.html';
  document.querySelector('#p_mail').value = u.email || '';
  document.querySelector('#p_nick').value = u.nickname || '';
  renderMyPosts();
  const mine = getCompletions().filter(x=> x.user.uid===u.uid);
  document.querySelector('#stat_posts').textContent = mine.length;
  document.querySelector('#stat_likes').textContent = mine.reduce((s,x)=> s+(x.likes||0),0);
}
function saveProfile(){
  const u = getUser(); if(!u) return;
  u.nickname = document.querySelector('#p_nick').value.trim()||u.nickname;
  setUser(u);
  toast('Profil kaydedildi');
}
function renderMyPosts(){
  const u = getUser(); const wrap = document.querySelector('#myPosts'); wrap.innerHTML='';
  const mine = getCompletions().filter(x=> x.user.uid===u.uid);
  if(!mine.length){ wrap.innerHTML='<p class="subtle">Henüz gönderin yok</p>'; return; }
  mine.forEach(item=>{
    const div=document.createElement('div'); div.className='card';
    div.innerHTML = `<div class="flex" style="justify-content:space-between">
      <div><b>@${item.user.nick}</b> • <span class="subtle">${timeAgo(item.ts)}</span></div>
      <div class="flex">
        <button class="btn small ghost" onclick="shareOrCopy('LafKat: “'+ item.text + '”')">Paylaş/Kopyala</button>
        <button class="btn small ghost" onclick="del('${item.id}')">Sil</button>
      </div>
    </div><p style="margin:10px 0">${item.text}</p>`;
    wrap.appendChild(div);
  });
}
function del(id){
  const arr = getCompletions().filter(x=> x.id!==id);
  localStorage.setItem(LS.completions, JSON.stringify(arr));
  renderMyPosts();
  toast('Silindi');
}
</script>
</body>
</html>
