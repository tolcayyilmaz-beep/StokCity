<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lafkat â€“ GiriÅŸ</title>
<meta name="description" content="Lafkat hesabÄ±na giriÅŸ yap." />
<style>
  :root{
    --orange-1:#ff7a1a; --orange-2:#f36a00;
    --card:#fff9f2; --ink:#2b2b2b; --muted:#7b7b7b; --ring:rgba(0,0,0,.10);
    --shadow:0 10px 30px rgba(0,0,0,.25), 0 2px 8px rgba(0,0,0,.10);
    --radius:20px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--ink);
    background:
      radial-gradient(120vmax 120vmax at 90% -20%, rgba(255,255,255,.12), transparent 55%),
      linear-gradient(180deg,var(--orange-1),var(--orange-2));
    background-attachment:fixed;
    display:grid; place-items:center; padding:24px;
  }
  .shell{width:min(960px,100%);display:grid;grid-template-columns: 1.1fr .9fr;gap:18px}
  @media (max-width:900px){ .shell{grid-template-columns:1fr} }
  .card{background:var(--card);border:1px solid var(--ring);border-radius:var(--radius);box-shadow:var(--shadow)}
  .left{padding:22px 22px}
  .right{padding:22px 22px}
  .brand{display:flex;align-items:center;gap:12px;margin-bottom:10px}
  .brand img{width:40px;height:40px;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,.25)}
  .brand .t{font-weight:900;font-size:24px;color:#7a4a16}
  h1{font-size:22px;margin:6px 0 2px}
  p{margin:8px 0;color:var(--muted)}
  label{display:block;font-weight:800;margin:10px 0 6px}
  input[type="email"],input[type="password"]{
    width:100%;padding:12px 14px;border:1px solid rgba(0,0,0,.12);border-radius:12px;background:#fff
  }
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .btn{appearance:none;border:0;padding:11px 14px;border-radius:12px;font-weight:900;cursor:pointer;box-shadow:0 4px 14px rgba(0,0,0,.15)}
  .btn.primary{background:linear-gradient(180deg,#ffb37a,#ff8e3a);color:#3a240e}
  .btn.ghost{background:#fff;border:1px solid rgba(0,0,0,.12)}
  .hint{font-size:12px;color:var(--muted)}
  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
  .divider{height:1px;background:rgba(0,0,0,.08);margin:14px 0}
  .flex{display:flex;gap:8px;align-items:center}
  .toggle{position:relative}
  .toggle input{position:absolute;inset:0;opacity:0}
  .showpw{font-size:12px;color:#333}
  .toast{position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:999px;opacity:0;pointer-events:none;transition:opacity .25s}
  .toast.show{opacity:1}
  .links a{color:#2b2b2b}
  .mini-note{font-size:13px;color:#5a3a14;background:#fff3e0;border:1px dashed rgba(0,0,0,.12);padding:8px 10px;border-radius:10px}
</style>
</head>
<body>
  <div class="shell">
    <!-- Form -->
    <section class="card left">
      <div class="brand">
        <img src="assets/logo.png" alt="" onerror="this.style.display='none'"><div class="t">Lafkat</div>
      </div>
      <h1>GiriÅŸ</h1>
      <p class="hint">ZiyaretÃ§i modu yalnÄ±zca okumaya izin verir. EtkileÅŸim iÃ§in giriÅŸ yap.</p>

      <form id="loginForm">
        <label for="lemail">E-posta</label>
        <input id="lemail" type="email" autocomplete="email" required placeholder="ornek@posta.com" />

        <div class="row" style="justify-content:space-between;align-items:flex-end;margin-top:4px">
          <div style="flex:1">
            <label for="lpass">Åžifre</label>
            <input id="lpass" type="password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
          </div>
          <label class="flex toggle" style="margin-bottom:6px"><input type="checkbox" id="showPw"><span class="showpw">GÃ¶ster</span></label>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn primary" type="submit">GiriÅŸ Yap</button>
          <a class="btn ghost" href="kayit.html">KayÄ±t Ol</a>
        </div>

        <div class="footer">
          <a class="hint" href="#" id="forgot">Åžifreyi mi unuttun?</a>
          <div class="links hint">Devam ederek <a href="#">KullanÄ±m ÅžartlarÄ±</a> ve <a href="#">Gizlilik</a>â€™i kabul etmiÅŸ olursun.</div>
        </div>
      </form>
    </section>

    <!-- Yan panel -->
    <aside class="card right">
      <h1>BugÃ¼nÃ¼n CÃ¼mlesi</h1>
      <p class="hint">GiriÅŸ yapmadan sadece okuyabilirsin:</p>
      <div class="mini-note" id="dailyBox">
        ArkadaÅŸÄ±m gizlice defterime bir ÅŸeyler yazmÄ±ÅŸ. SayfayÄ± aÃ§tÄ±ÄŸÄ±mda kocaman <u>_____</u> yazÄ±sÄ±nÄ± gÃ¶rdÃ¼m.
      </div>
      <div style="height:8px"></div>
      <a class="btn ghost" href="index.html">Anasayfaya dÃ¶n</a>
    </aside>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

<!-- ðŸ”§ TEK MODULE SCRIPT: Firebase init + giriÅŸ akÄ±ÅŸÄ± -->
<script type="module">
  import { auth } from "./firebase-init.js";
  import {
    signInWithEmailAndPassword,
    sendEmailVerification,
    sendPasswordResetEmail
  } from "https://www.gstatic.com/firebasejs/10.12.1/firebase-auth.js";

  const toast=(m)=>{const t=document.getElementById('toast');t.textContent=m;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1600)};

  // Åžifre gÃ¶ster/gizle
  document.getElementById('showPw').addEventListener('change', (e)=>{
    document.getElementById('lpass').type = e.target.checked ? 'text' : 'password';
  });

  // GiriÅŸ (email doÄŸrulamasÄ± kontrolÃ¼ ile)
  document.getElementById('loginForm').addEventListener('submit', async (e)=>{
    e.preventDefault();
    const email=document.getElementById('lemail').value.trim();
    const pass =document.getElementById('lpass').value;

    if(!email || !pass) return toast('E-posta ve ÅŸifre gerekli');

    try{
      const { user } = await signInWithEmailAndPassword(auth, email, pass);

      if(!user.emailVerified){
        const again = confirm('E-posta doÄŸrulanmamÄ±ÅŸ. DoÄŸrulama e-postasÄ±nÄ± yeniden gÃ¶ndereyim mi?');
        if(again){
          try{ await sendEmailVerification(user); toast('DoÄŸrulama e-postasÄ± gÃ¶nderildi'); }catch(err){ toast('GÃ¶nderilemedi: '+(err.code||err.message)); }
        }
        return; // DoÄŸrulanÄ±ncaya kadar iÃ§eri alma
      }

      toast('GiriÅŸ baÅŸarÄ±lÄ±');
      setTimeout(()=> location.href='index.html', 700);

    }catch(err){
      console.error('[Login]', err);
      toast('GiriÅŸ baÅŸarÄ±sÄ±z: ' + (err.code || err.message));
    }
  });

  // Åžifre sÄ±fÄ±rlama (gerÃ§ek akÄ±ÅŸ)
  document.getElementById('forgot').addEventListener('click', async (e)=>{
    e.preventDefault();
    const email = prompt('E-posta adresini gir:');
    if(!email) return;
    try{
      await sendPasswordResetEmail(auth, email);
      toast('SÄ±fÄ±rlama baÄŸlantÄ±sÄ± gÃ¶nderildi');
    }catch(err){
      console.error('[Reset]', err);
      toast('GÃ¶nderilemedi: ' + (err.code || err.message));
    }
  });
</script>
</body>
</html>
